/* ============================================================================
   SCRIPT PARA INSERTAR PRODUCTOS EN FIREBASE (PRODUCCIÃ“N)
   ============================================================================

   Este script funciona tanto en desarrollo como en producciÃ³n.
   Usa Firebase desde el objeto window global.

   INSTRUCCIONES:
   1. Abre tu sitio web en Chrome (desarrollo o producciÃ³n)
   2. Abre la consola de Chrome (F12)
   3. Copia y pega TODO este cÃ³digo
   4. Presiona Enter
   5. Espera a que se complete la inserciÃ³n
   6. Recarga la pÃ¡gina para ver el producto

   ============================================================================ */

(async function() {
  console.log('ğŸš€ Iniciando script de inserciÃ³n de producto...');

  try {
    // Cargar Firebase dinÃ¡micamente desde CDN
    console.log('ğŸ“¦ Cargando Firebase desde CDN...');

    // Importar Firebase App
    const firebaseApp = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js');
    const firebaseFirestore = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js');

    const { initializeApp, getApps } = firebaseApp;
    const { getFirestore, doc, setDoc, serverTimestamp } = firebaseFirestore;

    // ConfiguraciÃ³n de Firebase (usa tus credenciales)
    const firebaseConfig = {
      apiKey: "AIzaSyAMKAQCHu0M7e7CnzYl4xKBQxMLlKNgjr0",
      authDomain: "frostware.firebaseapp.com",
      projectId: "frostware-website",  // âš ï¸ IMPORTANTE: Usar el proyecto correcto
      storageBucket: "frostware-website.firebasestorage.app",
      messagingSenderId: "850493009299",
      appId: "1:850493009299:web:7a6e2f0f67e31d8e72eba4",
      measurementId: "G-LQQTD3PWLQ"
    };

    // Inicializar Firebase solo si no estÃ¡ inicializado
    let app;
    const existingApps = getApps();
    if (existingApps.length === 0) {
      console.log('ğŸ”§ Inicializando Firebase...');
      app = initializeApp(firebaseConfig);
    } else {
      console.log('âœ… Firebase ya estÃ¡ inicializado');
      app = existingApps[0];
    }

    // Obtener referencia de Firestore
    const db = getFirestore(app);

    if (!db) {
      console.error('âŒ No se pudo obtener Firestore');
      return;
    }

    console.log('âœ… Firebase y Firestore inicializados correctamente');

    // ========================================================================
    // DATOS DEL PRODUCTO - MODIFICA ESTA SECCIÃ“N PARA TUS PRODUCTOS
    // ========================================================================

    const productData = {
      // ID Ãºnico del producto (sin espacios, solo letras, nÃºmeros y guiones)
      id: 'north-atlantic-ops',

      // Nombres del producto (bilingÃ¼e: espaÃ±ol e inglÃ©s)
      name: {
        es: 'Procedimientos Operacionales del AtlÃ¡ntico Norte',
        en: 'North Atlantic Operational Procedures'
      },
      title: {
        es: 'Procedimientos Operacionales del AtlÃ¡ntico Norte',
        en: 'North Atlantic Operational Procedures'
      },

      // Descripciones del producto (bilingÃ¼e)
      description: {
        es: 'Un banco de preguntas completo para pilotos transoceÃ¡nicos que operan en el espacio aÃ©reo del AtlÃ¡ntico Norte. Basado en documentos oficiales de OACI con referencias y justificaciones.',
        en: 'A comprehensive question bank for transoceanic pilots operating in North Atlantic airspace. Based on official ICAO documents with references and justifications.'
      },
      shortDescription: {
        es: 'Un banco de preguntas completo para pilotos transoceÃ¡nicos que operan en el espacio aÃ©reo del AtlÃ¡ntico Norte. Basado en documentos oficiales de OACI con referencias y justificaciones.',
        en: 'A comprehensive question bank for transoceanic pilots operating in North Atlantic airspace. Based on official ICAO documents with references and justifications.'
      },
      longDescription: {
        es: 'El banco de preguntas mÃ¡s completo para pilotos transoceÃ¡nicos. Estudia procedimientos oficiales de OACI, practica con escenarios reales y aprueba tu certificaciÃ³n de operaciones NAT con confianza.',
        en: 'The most comprehensive question bank for transoceanic pilots. Study official ICAO procedures, practice with real scenarios, and pass your NAT operations certification with confidence.'
      },

      // Precios
      price: 99,
      originalPrice: 150,

      // ImÃ¡genes
      image: 'https://placehold.co/600x400/1a202c/FFFFFF?text=NAT+OPS&font=inter',
      imageURL: 'https://placehold.co/600x400/1a202c/FFFFFF?text=NAT+OPS&font=inter',

      // CategorÃ­a y etiquetas
      category: 'aviation',
      badge: 'Disponible',
      badgeColor: 'blue',
      tags: ['aviation', 'NAT', 'oceanic', 'procedures'],

      // Rating y reseÃ±as
      rating: 5.0,
      reviews: 342,

      // Colores para el gradiente en la pÃ¡gina de detalles
      colors: ['#1b1b25', '#190d36', '#1b1b25'],
      detailGradientColors: ['#1b1b25', '#190d36', '#1b1b25'],

      // CaracterÃ­sticas simples (aparecen en la lista)
      features: [
        'Banco de preguntas interactivo',
        'Documentos ICAO oficiales',
        'Referencias y justificaciones',
        'Acceso completo'
      ],

      // CaracterÃ­sticas detalladas (aparecen en la pÃ¡gina de detalles con iconos)
      detailedFeatures: [
        {
          icon: 'radio',
          title: {
            es: 'Procedimientos de ComunicaciÃ³n',
            en: 'Communications Procedures'
          },
          description: {
            es: 'Domina protocolos de radio HF, operaciones SELCAL y requisitos de reporte de posiciÃ³n para vuelos oceÃ¡nicos.',
            en: 'Master HF radio protocols, SELCAL operations, and position reporting requirements for oceanic flight.'
          }
        },
        {
          icon: 'map',
          title: {
            es: 'Sistemas de NavegaciÃ³n y Rutas',
            en: 'Navigation & Track Systems'
          },
          description: {
            es: 'Aprende sistemas de rutas NAT, procedimientos de waypoints y requisitos RNAV para navegaciÃ³n oceÃ¡nica segura.',
            en: 'Learn NAT track systems, waypoint procedures, and RNAV requirements for safe oceanic navigation.'
          }
        },
        {
          icon: 'cloud',
          title: {
            es: 'MeteorologÃ­a y Ambiente',
            en: 'Weather & Environmental'
          },
          description: {
            es: 'Comprende cartas SIGWX, reporte de turbulencias y cÃ³mo el clima afecta las operaciones NAT.',
            en: 'Understand SIGWX charts, turbulence reporting, and how weather affects NAT operations.'
          }
        },
        {
          icon: 'warning',
          title: {
            es: 'Procedimientos de Emergencia',
            en: 'Emergency Procedures'
          },
          description: {
            es: 'Practica procedimientos de contingencia, desvÃ­os y requisitos ETOPS para operaciones seguras.',
            en: 'Practice contingency procedures, diversions, and ETOPS requirements for safe operations.'
          }
        },
        {
          icon: 'certificate',
          title: {
            es: 'Listo para CertificaciÃ³n',
            en: 'Certification Ready'
          },
          description: {
            es: 'Preguntas diseÃ±adas para coincidir con exÃ¡menes de certificaciÃ³n reales con explicaciones detalladas y referencias.',
            en: 'Questions designed to match real certification exams with detailed explanations and references.'
          }
        },
        {
          icon: 'lightning',
          title: {
            es: 'Aprendizaje Interactivo',
            en: 'Interactive Learning'
          },
          description: {
            es: 'Pistas, explicaciones detalladas y seguimiento de progreso para optimizar tus sesiones de estudio.',
            en: 'Hints, detailed explanations, and progress tracking to optimize your study sessions.'
          }
        }
      ],

      // ConfiguraciÃ³n
      showOnHomepage: true,
      appUrl: '/apps/north-atlantic-procedures/guide.html',
      offerId: null,

      // Timestamps (se generan automÃ¡ticamente)
      createdAt: serverTimestamp(),
      updatedAt: serverTimestamp()
    };

    // ========================================================================
    // INSERCIÃ“N EN FIREBASE - NO MODIFICAR ESTA SECCIÃ“N
    // ========================================================================

    console.log('ğŸ“ Insertando producto:', productData.id);
    console.log('   Nombre:', productData.name.es);
    console.log('   Precio: $' + productData.price);

    await setDoc(doc(db, 'products', productData.id), productData);

    console.log('');
    console.log('âœ… Â¡PRODUCTO INSERTADO EXITOSAMENTE!');
    console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
    console.log('');
    console.log('ğŸ“Š RESUMEN DEL PRODUCTO:');
    console.log('   ğŸ†” ID: ' + productData.id);
    console.log('   ğŸ“ Nombre (ES): ' + productData.name.es);
    console.log('   ğŸ“ Nombre (EN): ' + productData.name.en);
    console.log('   ğŸ’° Precio: $' + productData.price + ' (antes $' + productData.originalPrice + ')');
    console.log('   ğŸ“ CategorÃ­a: ' + productData.category);
    console.log('   â­ Rating: ' + productData.rating + '/5.0 (' + productData.reviews + ' reviews)');
    console.log('   âœ¨ Features: ' + productData.features.length + ' simples, ' + productData.detailedFeatures.length + ' detalladas');
    console.log('   ğŸ¨ Colores: ' + productData.detailGradientColors.join(', '));
    console.log('');
    console.log('ğŸ”— ENLACES:');
    console.log('   ğŸ“„ Ver producto: ' + window.location.origin + '/#/product/' + productData.id);
    console.log('   ğŸš€ App URL: ' + (productData.appUrl || 'No definida'));
    console.log('');
    console.log('ğŸ“‹ CONTENIDO INCLUIDO:');
    console.log('   âœ“ Nombres bilingÃ¼es (ES/EN)');
    console.log('   âœ“ Descripciones bilingÃ¼es (corta, larga)');
    console.log('   âœ“ ' + productData.features.length + ' caracterÃ­sticas simples');
    console.log('   âœ“ ' + productData.detailedFeatures.length + ' caracterÃ­sticas detalladas con iconos');
    console.log('   âœ“ Gradiente de colores personalizado');
    console.log('   âœ“ Badge, rating y reviews');
    console.log('   âœ“ Timestamps automÃ¡ticos');
    console.log('');
    console.log('ğŸ”„ RECARGA LA PÃGINA para ver el producto en acciÃ³n');
    console.log('');
    console.log('ğŸ’¡ COMANDOS ÃšTILES:');
    console.log('   Para eliminar: deleteProductById("' + productData.id + '")');
    console.log('   Para ver todos: checkFirebaseProducts()');
    console.log('');
    console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');

    return productData;

  } catch (error) {
    console.error('');
    console.error('âŒ ERROR AL INSERTAR PRODUCTO');
    console.error('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
    console.error('Error:', error.message);
    console.error('Detalles:', error);
    console.error('');
    console.error('ğŸ” Verifica que:');
    console.error('   1. EstÃ¡s en la pÃ¡gina correcta de tu sitio');
    console.error('   2. Firebase estÃ¡ inicializado (window.firebase debe existir)');
    console.error('   3. Tienes permisos para escribir en Firestore');
    console.error('   4. El ID del producto no existe ya');
    console.error('');
    console.error('ğŸ’¡ Para verificar Firebase:');
    console.error('   Ejecuta: console.log(window.firebase)');
    console.error('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
    throw error;
  }
})();
